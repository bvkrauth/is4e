# Cleaning data with Excel

In this chapter we will learn how to:

 - Use Excel tools to view data, including:
   - Sorting
   - Filtering
   - Freezing panes
 - Use Excel tools to enter new data and "clean" existing data, including
   - Fill and series
   - Formulas
   - Functions
 - Learn basic Excel terminology and concepts including:
   - Workbooks, worksheets, and cells
   - Cell contents and display format
   - Relative and absolute cell addresses
   - Ranges of cells
 - Follow good data management practices 

## A quick tour of Excel

Many students have already used Excel, but we will start by going over 
some of its basic characteristics and terminology.

### Terminology and interface

Start Excel. Your screen should look something like this:

[INSERT PICTURE HERE]

When giving instructions, I will refer to various elements of Excel's user
interface by name. You may have been using these elements for years without
ever knowing their names, so I will list them here:

- An Excel file is called a ***workbook***.
  - in Windows, Excel files normally have the extension `.xlsx`
- Each workbook contains one or more ***worksheets***.
  - Only one worksheet is displayed/active at a time.
  - You can switch between worksheets, rename worksheets, or add 
      new worksheets by clicking on the tabs at the bottom of the 
      screen.
- Each worksheet is a rectangular grid of ***cells***. 
- Each cell has an ***address*** that identifies its column by
  letter and its row by number. 
  - For example, the cell in the third column (column *C*) and fifth row 
    (row *5*) is called cell *C5*. 
- Each cell contains one of the following:
  - Nothing (blank)
  - A ***value***, usually a number, text string, or date.
  - A ***formula*** for calculating a value.
- The ***menu bar*** is the top row of text marked `File Home Insert Draw ...`:
   ![menu bar](Excel menu bar.jpg)
- The ***ribbon*** is the row of buttons below the menu bar:
   ![ribbon](Excel ribbon.jpg)
  - The ribbon has buttons for performing simple actions.
  - The buttons are grouped by function, for example there is a group called
    "Clipboard" and another called "Font".
    - Within each function group, there is usually a little icon in the
      lower-right corner that you can click on to access additional options.
  - If your ribbon is not visible:
    - You can make it visible by clicking "Home" (or anything else) on the
      menu bar. 
    - Once you have made the ribbon visible, you can keep it visible by
      clicking on the little thumbtack icon in its lower right corner.
  - The contents of the ribbon depend on the currently-active menu bar option
    (usually but not always `Home`). 
    - I will assume that Home is the currently-active option; if it isn't
      you can just click on `Home` to make it the currently-active option.
- The ***formula bar*** is the long white box just below the ribbon:
   ![formula bar](Excel formula bar.jpg)
   - It shows the contents of the current cell.
   - You can type in it to change the contents of the current cell.
- The ***insert function*** button is the little "fx" button to the left of the formula bar:
  ![insert function button](Excel insert function button.jpg)
   - We will learn to use this later.
- Most of the screen displays a grid of ***cells*** that is called 
   a ***spreadsheet*** or ***worksheet***:
   ![cell grid](Excel cell grid.jpg)
  - Columns are identified by letter.
    ![column](Excel column.jpg)
  - Rows are identified by number.
    ![row](Excel row.jpg)
  - The cell in column A, row 2 is called cell A2.
  - The active/selected cell is shaded or has a box around it:
   ![active cell](Excel active cell.jpg)
    - You can select an individual cell by clicking on it.
    - You can select any rectangluar group of cells.
    - You can select an entire column by clicking on the letter at the top of the column.
    - You can select an entire row by clicking on the number at the left of the row.
    - You can select all cells by clicking in the upper-left corner.
- Below the worksheet is a row of tabs named (in this particular case)
  "Table 1" and "Table 2".  
  ![tabs](Excel tabs.jpg)
  - You can click on a tab to switch to that worksheet.
  - You can double-click on a tab to change its name.
  - You can click on the "+" button to add a new worksheet.

### Tidy data

Download the data file at ***ADD LINK HERE*** and open it in Excel.

***INSERT SCREENSHOT HERE***

This data file provides the main employment statistics for Canadian provinces
in November 2020.  

- `Population` is the total civilian non-institutionalized working age 
   (15+) population.
- `Employed` is the count of people in that population who were employed.
- `Unemployed` is the count of people in that population who were unemployed,
   i.e., they were not employed but were actively looking for work.

These statistics are calculated by Statistics Canada using a monthly survey
called the Labour Force Survey (LFS), and are used to measure things like
the unemployment rate and the labour force participation rate.

The data in this file takes the form of what data scientists sometimes
call **tidy** data. Tidy data takes a simple and convenient format:

- Data is arranged in one or more simple rectangular grids or ***tables***.
  - In Excel, tables should always start in cell A1.
- Each column in a table represents a distinct **variable** or attribute.
  - The top row should give an informative and unique name for each variable.
  - In Excel, the variable names are usually in **boldface**. 
- Each row in a table represents a distinct **observation** or ***case***.
  - The first column should provide a unique identifier for 
    each observation.
- All observations in a table come from the same **unit of observation**
  - In this example, the unit of observation is the Canadian province. That is,
    each row represents a different province.
  - If we have data at another unit of observation (for example, if we have data
    on individual cities, or for Canada as a whole), that data should should be 
    in another table.
- The order in which observations are listed is irrelevant to the analysis.
  - In this example, the observations are listed in alphabetical order. But
    we could re-order it by population without changing the meaning of 
    any of the data.
  - If there is a natural ordering of the data, that ordering should be
    expressed in a variable. For example, a data set on annual GDP should not
    just be a list of GDP values that happens to be ordered by year. It 
    should also include a variable for the year.

To see what messy data looks like, click on the `Raw data` tab at the bottom 
of the page.  This worksheet shows the original data set as I originally downloaded it from Statistics Canada.

***INSERT SCREENSHOT HERE***

If we are lucky, our data is already tidy. But most data sources are messy, 
and we will often need to "clean" our data (convert from a messy to a tidy
format) before starting our analysis. In many projects, the data cleaning 
is a bigger job than the data analysis.

### Excel tools for viewing data

We will start by learning a few tools for viewing our data.

#### Sorting

The original data are in alphabetic order by province name. But suppose 
we wanted it to ordered by population (with the highest populations on top)
instead. Here's all we need to do:

1. Place the cursor in any cell in the `Population` column.
2. Click `Home`, then  `Sort and Filter`. A drop-down list of options
   will appear.
3. Select "Sort Largest to Smallest".

As you can see, the data set is now sorted by population. We can follow
similar steps to put the data set back in alphabetical order:

1. Place the cursor in any cell in the `Province` column.
2. Click `Home`, then  `Sort and Filter`. A drop-down list of options
   will appear.
3. Select "Sort A to Z".

Notice that Excel can tell whether a column contains numbers or text, and 
will sort accordingly. 

Advanced options: 

- You can sort on multiple columns by selecting the "Custom sort" option.

#### Filtering

We will often want to look at a particular subgroup of observations.
This is called  ***filtering***.

Suppose we only want to see data for larger provinces. Here's what we can do:

1. Select `Home` and then `Sort and Filter`. A drop-down list of options
   will appear.
2. Select `Filter`. If you look at the column headers in your sheet you will
   see that they have become drop-down boxes.
3. Click on the drop-down box for "Population", then select `Number filters`
   then `Greater Than..." 
4. Enter one million (1000000) in the box and select `OK`.

At this point, only the provinces with at least one million residents
appear in the table. Don't worry, the other ones haven't gone anywhere.

We can undo the filter and remove the drop-down boxes by selecting
`Home`, then `Sort and Filter` and then `Filter`.

This is a simple example, but we can construct much more complex filters.

#### Contents and display format

The ***contents*** of a cell can be:

- Empty/blank
- A ***value***, which is either 
  - A text string
  - A number
  - A date
  - A logical value (TRUE or FALSE)
  - An error value (more on these later)
- A ***formula***, which is a rule for calculating a value.

A cell's contents are distinct from its ***display format***, which is how
it appears on the screen. We can change the display format of a cell or 
group of cells without changing its contents. 

For example, the numbers in our table are quite large and would
be easier to read with commas. For example it would be nice if cell B2 
displayed `3,588,700` instead of `3588700`. 

To do that:

1. Select the cell(s) we want to change
  - You can select cell B2 individually.
  - You can also select the range B2:D11, or all of columns B through D.
2. Look for a drop-down box in the middle of the ribbon (it will say 
   "General"), and click on it. You should see a list of
   number formats to choose from, including "Time," "Percentage," etc.
3. Select "More number formats." This will take you to a dialog box with many 
   options. Select `Number` from the list, change `Decimal places` 
   from 2 to 0, and click on the `Use 1000 separator (,)` check box.
   Then select `OK`
   
An important thing to understand is that the contents of the cell have not 
changed, only the way they are displayed. You can see the "real" contents
of a cell by clicking on it and looking at the ***I FORGET THE NAME***.

Any calculations using a cell are based on its contents and not on its display 
format. For example, cells are often rounded for display but any calculations
involving those cells will be based on its un-rounded value.

In addition to changing the way that numbers display, you can change many
other aspects of display formatting including: 

- font,
- bold/italics/underline
- text color
- background color
- cell borders
- alignment (left/right/center as well as top/bottom/middle) 

We will keep things simple in this class.

#### Freezing panes

Go down to row 50 or so in your worksheet. Notice that you can't 
see the variable names in row 1 any more. This is fine for our current
data set, but it would be a problem if we had more than a few rows.

The solution to this problem is to ***freeze panes***, which means 
to keep some rows and/or columns visible regardless of which cell 
the cursor is in.

1. Go back to cell A1.
2. Select `View` and then `Freeze Panes`, and then select `Freeze Top Row`.

Now go back down to row 50 or so. You will see that the top row is still
displayed and you can see the variable names.

To undo this, select `View` and `Freeze Panes` again, and then click on
"Unfreeze Panes."

You can also freeze the first column, or you can freeze any number of 
rows and columns.

## Cleaning data

We are now ready to start cleaning our data. 

Remember: we want to leave the original data alone whenever possible. 
So we will create new variables rather than changing the original variables. 

### Entering new data

The simplest way to add variables to an Excel table is by entering data
directly.

#### Manual data entry

We will start by simply typing in some new data.

The "Province" column gives the name of each person's province of residence.
It might be more convenient to use the two-letter postal abbreviation instead,
so let's add that as a new variable. Here's the table of abbreviations
for your reference:

| Province or Territory| ProvAbb |
|----------------------|:-------:|
| Alberta                   | AB |
| British Columbia          | BC |
| Manitoba                  | MB |
| New Brunswick             | NB |
| Newfoundland and Labrador | NL | 
| Northwest Territories     | NT |
| Nova Scotia               | NS |
| Nunavut                   | NU |
| Ontario                   | ON |
| Prince Edward Island      | PE | 
| Quebec                    | QC |
| Saskatchewan              | SK |
| Yukon                     | YT |

So let's add our variable:

1. Name the variable "ProvAbb" by entering that text in cell E1.
2. Fill in the remaining cells in column E with the correct postal 
   abbreviation.

That's all we need to do.

#### Using Fill and Series

Ideally, one of the variables in our table serves as a ***unique identifier***
for observations. A unique identifier (ID) is a text or numeric (integer)
variable that takes on a different value for each observation. 

In our data set, the province name can be used as a unique identifier. But names
are not always unique; for example there are 41 cities and towns in the United
States named "Springfield." So it is often wise to assign an arbitrary number
as a unique ID.

Let's create a unique ID variable for our data set. The ID doesn't need to
mean anything, so we can just number them sequentially. It would also 
be convenient if it the ID variable were in column A.

1. Move the cursor to any cell in column A, and then click on `Home` then
   on the little drop-down-arrow next to`Insert` and then 
   `Insert Sheet Columns`.  This inserts an empty column 
   to the left of (what used to be) column A.
2. Give our variable a name by entering "ID" in cell A1.
3. We can enter the ID numbers by hand, but there is an easier way. 
   a. Enter 1 in cell A2.
   b. Select cells A2:A11.
   c. Select the drop-down-arrow next to the `Fill` button 
      (it will be a little box with a downwards arrow in it) 
      and then select `Series...`.  The Series dialog box will
      appear.
   d. There are several options for constructing a series. Fortunately, the
      default is exactly what we want, so click the "OK" button.

As you can see, column A now contains a unique identifier that numbers provinces
from 1 to 10.

We can also use the Fill button to fill in a group of cells with the same
value.

### Formulas

Most of the time our new variables will be calcuated from existing variables.
To do this, we will use ***formulas***. A formula is just a rule for
calculating a value from some other values.

#### A simple formula

We will start with a very simple formula. 

Returning to our application, everyone who is either employed or unemployed
is in what economists call the "labour force." So let's add variables for 
LF and NLF.

1. Enter "LabourForce" in cell G1 to name the variable.
   - Note that I avoid putting spaces in variable names.
2. Enter "= D2 + E2" in cell G2.

Cell G2 now displays `2,493,300` which is in fact the value in cell D2 
plus the value in cell E2. Notice that the formula bar shows "=D2+E2" and 
*not* `2,493,300` or `2493300`. That is because the true contents of the 
cell are the calculation itself (the formula) and not the results of the
calculation (the value).

Because the cell contains the formula and not its result, the value displayed
in cell G2 will change if the data changes.  To see this:

1. Change the value in cell E2 from `276700` to `5`.
   - The value displayed in cell G2 changes to `2,216,605`
2. Change the value in cell E2 back to `276700`.
   - The value displayed in cell G2 changes back to its original value.
   
Excel will usually recalculate all formulas in the sheet whenever anything is 
changed.

#### Copying, pasting and relative references

We haven't yet filled in the remaining cells in column G. It would be 
inconvenient to type a formula into each cell, and would quickly become
very time-consuming with a larger data set.

Fortunately, we can copy the formula in cell G2 and paste it to 
the other cells. 

1. Select cell G2 and copy it.
2. Select the other cells in column G, and paste.

Now, go to cell G3 and take a look at the formula bar. You'll notice that
while the original cell G2 contains "=D2+E2", cell G3 actually contains
"=D3+E3". Excel is smart and normally treats cell addresses in formulas 
as ***relative references*** rather than ***absolute references***
when copying and pasting cells.  This is usually exactly what we want it to
do.

Sometimes we will want Excel to treat a cell reference as absolute and not
relative. Fortunately there is a way to do this - we will do that soon.

### Functions

Excel has about 500 built-in functions that we can use in formulas. It also
has extensive tools for finding the function you need for a particular
calculation task, and for figuring out what arguments to use in the function.

#### A simple function

Suppose we want to add a new variable for the (natural) log of population.

1. Enter "LogPop" in cell H1 to give the variable a name.
2. Move to cell H2. Now we need to find the name and format 
   of the Excel function that calculates the natural log. 
3. To the left of the formula bar there is a little button 
   marked ![insert function button](Excel insert function button.jpg) 
   Click on that button and the "Insert Function" 
   dialog box will appear.  It will have a very long list 
   of functions. You will want to narrow this list down: 
   - There is a box in which you can enter search text,
     for example "logarithm".
   - You can select a category, for example "Math & Trig"
4. Once you have narrowed the list down, it is easy to find
   the function you want (LN). Select `LN` from the list
   box, and then click `OK`. 
   - You will now see the Function Arguments dialog box
     for the LN function.
5. As you can see, the LN function takes one argument
   (the number you want the log of). You want to take the 
   log of cell C2, so you could just enter the text "C2"
   here.  But let's try something new: click on cell C2
   itself. You will see several things happen:
   - the text box will now contain "C2"
   - the dialog box will display the value in cell C2 (3588700)
     as well as the calculated value for the log of cell
     C2 (15.0933058).
6. Click the "OK" button.

You will see that cell H2 now contains "=LN(C2)" which displays as 15.0933. 
Note that if you already knew the function and arguments you needed, you could 
have just typed "=LN(C2)" into cell H2 instead.

#### Using Fill instead of copy-and-paste

Now that we have the formula we want in cell H2, we want to copy it into the
rest of column H.  We could copy-and-paste just like before, but let's try a
slightly different way.

1. Select cells H2:H11.
2. Click on the "Fill" button.
3. Select "Down"

As you can see, the contents of cell H2 have been filled in to the other
cells, which is what we wanted. Again, the cell references have all been
updated.

### Cell references

#### Cell ranges

Some functions like SUM() and AVERAGE() operate on a ***range*** of cells
rather than a single cell or list of cells. A range is just a 
rectangular set of cells, and is described by its upper-left and lower-right 
cells, separated by a colon (":"). For example:

- Range A2:A5 consists of cells A2, A3, A4 and A5.
- Range A2:C2 consists of cells A2, B2, and C2.
- Range A2:B3 consists of cells A2, B2, A3, and C3.

Suppose we want to create a new variable that reports the total population
across all observations in the data. The function to do that is SUM(). 

1. Enter "TotPop" in cell I1 to give the variable a name,
   and then move to cell I2.
2. Enter "=SUM(C2:C11)" in cell I2.  

Cell I2 should display `31,275,600` which is indeed the sum of 
cells C2 to C11.

#### Absolute references 

Let's complete our TotPop variable by copying cell I2 to the remaining
cells in column I.  You will notice something strange: the other cells don't
show the same number as cell I2.  Why is this?

Remember that Excel normally interprets cell references
as *relative to the current cell* when performing copy-and-paste
or fill operations. This is normally what we want Excel to
do. But in this case it results in cell I3 (for example)
containing the sum of cells C3:C12 rather than the sum
of C2:C11 like we want.

To fix this, we need to tell Excel that we want certain references 
to be treated as absolute rather than relative.
To do that, we add the character "$" before each such reference.

1. Go back to cell I2.
2. Change "=SUM(C2:C11)" to "=SUM(C$2:C$11)".
   - Notice that the value in this cell does not change.
3. Use copy-and-paste or fill to fill in the rest of the column.
   - Notice that all cells in this column display the same contents
      (`=SUM(C$2:C$11)`) and value (`31,275,600`)

This is what we want.

#### Combining absolute and relative references

Sometimes we will want to combine absolute and relative references in the
same formula.

Suppose we want to create a new variable that is the province's population
*rank*. That is, the province with the highest population has a rank of 1, 
second highest has a rank of 2, etc. The function to do that is RANK.EQ()

1. Enter "PopRank" in cell J1 to give the variable a name, and go to cell
   J2.
2. Use the Insert Function tool to access the arguments for RANK.EQ(). Enter
   the appropriate arguments and press "OK":
   - Number is the number we wish to rank: enter C2
   - Ref is the set of values we want to rank within: enter the range C2:C11.
   - Order is an optional argument: leave it blank.

As you can see, Excel displays the correct rank (4) for this row. 

But before we copy this formula to the rest of column J, think about 
what we want to change and what we want to stay the same.

- The Number argument should change from C2 to C3. Leave it as a relative
  reference.
- The Ref argument should stay the same. Change it to an absolute reference

So our next step is:

4. Change "=RANK(C2,C2:C11)" to "=RANK(C2,C$2:C$11)"
5. Use copy-and-paste or fill to fill in the rest of column J.

As you can see, Excel displays the correct ranks. We can check this by sorting
on Population and seeing if PopRank is also sorted.

> DO WE ALSO WANT TO DO PERCENTRANK HERE?  IT ISN'T USED ANYWHERE ELSE.

### Logical data

In addition to text and numbers, cells can also contain ***logical***
values (TRUE or FALSE). Logical values can be entered directly in 
a cell, can be used in a formula, and can be the result of a formula.

To see how the logical values work, go to cell K2.

- You can use the comparison operators ("=", ">", "<", etc.) to produce
  logical results.  For example:
  - Enter `=(B2="Alberta")` in cell K2. It will display `TRUE`.
  - Enter `=(B2="Ontario")` in cell K2. It will display `FALSE`.
  - Enter `=(C2 < 1000000)` in cell K2. It will display `TRUE`.
- Excel will convert `TRUE` to 1 AND `FALSE` to 0 when used in a 
   numeric calculation. For example:
   - Enter `=TRUE+TRUE` in cell K2. It will display `2`
   - Enter `=FALSE+5` in cell K2. It will display `5`
  - If you use a number in a logical calculation, zero will be treated
    as FALSE and all other values will be treated as TRUE.
- There are some functions that expect logical arguments. These 
  include IF(), AND(), OR(), and NOT().

Let's use some of these tools to create a variable with the following
characteristics:

1. It equals 1 for all provinces with population over one million.
2. It equals 0 for all provinces with population below one million.

A variable that equals one when a condition holds and zero otherise
is called an *indicator* or *dummy* variable for the condition. Indicator
variables are very similar to logical variables but are numbers.  Logical
variables have their uses, but statistical analysis is easier when working 
with numbers.

1. Enter "BigPop" in cell K1 to give the variable a name.
2. Go to cell K2 to enter the formula. 
   We will use the IF() function. Use the Insert Function button
   to find it and view its three arguments. Enter the arguments below and 
   presss `OK`:
   - logical_test: enter C2>1000000
   - value_if_true: enter 1
   - value_if_false: enter 0

This should display as 1.  Fill in the rest of the column, and you should see
1 for all of the larger provinces and 0 for all of the small provinces.

ALSO COVER SWITCH()

### Text data

While normal arithmetic operations like addition or multiplication do not 
operate on text, there are many useful functions to manipulate text strings
in Excel:

- `LEN()` calculates the length (number of characters) of a string. 
   For example: 
   - `=LEN("Hello world!")` returns the value of 12. 
- `MID()` allows you to extract part of a string.  For example 
   - `=MID("Hello world!",2,3)` returns a value of "ell".  
- `CONCAT()` allows you to join (concatenate) two or more strings. For example
   - `=CONCAT("Hello","world")` returns a value "Helloworld".
- `UPPER()`, `LOWER()` and `PROPER()` allow you to change the case of a string.
   For example:
   - `=UPPER("Hello world!")` returns "HELLO WORLD!", 
   - `=LOWER("Hello world!")` returns "hello world!", and 
   - `=PROPER("Hello world!")` returns "Hello World!".
- `FIND()` allows you to find a particular substring within a larger string,
   and
   - `=FIND("world!","Hello world!")` returns 7
- `REPLACE()` allows you to replace part of a string.
   - `=REPLACE("Hello world!",7,5,"mom")` returns "Hello mom!"

### Dates and times

In additions to numbers, text, and logical values, Excel can handle dates
and times.  However, dates and times are a surprisingly complex subject
and can create all sorts of problems:

- There are many ways of writing the same date:
   - November 1, 2020
   - 2020 November 1
   - 14 Heshvan 5781 (Hebrew calendar)
   - 11/1/2020
   - 11/1/20
   - 11-1-2020
   - 2020/11/1
   - etc.
- Customs vary across cultures, in some places 11/1 is November 1
   and in others it is January 11.
- We want to be able to sort and rank, so that January 10, 2020 comes 
   before December 10, 2020.
- We want to be able to add and subtract, so that January 4, 2021
   comes 5 days after December 30, 2020.

Excel follows a variation of a standard solution:

1. Dates are stored in a standardized internal representation, usually
   the number of days elapsed since some base date. In Excel the base 
   date is January 1, 1900, which means that
   - January 1, 1900 is day 1.
   - January 2, 1900 is day 2.
   - November 1, 2020 is day 44136.
2. Display formatting determines how the date is displayed. 
3. When Excel reads in what looks like a human-readable date, it 
   - guesses the date format for the input date
   - converts to the internal form
   - changes the display format to what Excel thinks it should be.
   
Most of the time, this works seamlessly and is very clever. But sometimes 
Excel guesses wrong, and this can create all sorts of problems.

Let's add a date column to our data set to see how it all works. The date
we use will be November 2020, the month and that this particular data set
describes.

1. Enter "MonthYr" in cell L1.
2. Enter "11/2020" in cell L2. Notice that several things happen:
   - The contents in the formula bar displays "11/1/2020"  We did not 
      give a specific day in November 2020, so Excel took our date
      as the first day in that month.
   - The cell displays as "Nov-20"
   - The number format (which was previously set at "General") has changed
      to "Custom"
3. Use copy/paste or Fill to fill in cells L3:L11.
      
Your computer may actually display the date slightly differently, depending
on its regional settings.

- To see the internal representation of this date, change the 
   display format to "General" or "Number".
- To show the date in another format, change the display format
   to "Short Date" or "Long Date". 
- You can see even more options if you select "More number formats"

We can also do calculations with dates, and there are various functions
using dates.

1. Enter "Now" in cell M1.
2. Enter `=TODAY()` in cell M2 to put in today's date.
   - This will return today's date.
   - Tomorrow, the cell will display tomorrow's date.
3. Enter "HowLongAgo" in cell N1.
4. Enter `=M2-L2` in cell N2.
   - This will display the number of days that have passed between
      November 1, 2020 and today.

Finally, Excel will treat times as partial days. For example,
Excel will store `11/1/2020  12:00:00 PM` as day 44136.5
and `11/1/2020  1:00:00 PM` as day 44136.5416666667. 

### Putting it all together

After all of that, we still have a few variables we need.  Let's practice
by adding them to our sheet.

1. The labour force participation rate is defined as the percentage of the 
   population that is in the labour force.  Calculate and report this rate
   for each province in column O:
   - The name of the variable should be LFPRate
   - Use a formula to calculate the rate as a proportion.  For example,
      the LFP rate for Alberta should be about 0.695
   - Use display formatting to display the rate as a percentage, 
     to one decimal place.  For example, the LFP rate 
      for Alberta should display as 69.5%.
2. The unemployment rate is defined as the percentage of the labour force
   that is unemployed. Calculate and report this rate
   for each province in column P:
   - The name of the variable should be UnempRate
   - Use a formula to calculate the rate, as a proportion.
   - Use display formatting to display the rate as a percentage, 
     to one decimal place.

Once you have completed this task, save the file and set it aside for later.

### Extras

You can type in a link or add the function HYPERLINK().

